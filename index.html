<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø³Ø¨Ø­Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªØ·ÙˆØ±Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <style>
    :root {
      /* Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© - Ø«ÙŠÙ… Ø£Ø®Ø¶Ø± */
      --primary: #2e7d32;
      --secondary: #ff9800;
      --accent: #2196f3;
      --success: #4caf50;
      --warning: #ff9800;
      --danger: #f44336;
      --bg: #f8fafc;
      --text: #2d3748;
      --card-bg: #ffffff;
      --border-color: #e2e8f0;
      --gradient: linear-gradient(135deg, #4caf50, #a5d6a7);
      --solid-bg: #4caf50;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
      --transition-slow: 0.6s ease;
      --transition-fast: 0.3s ease;
    }

    /* Ø«ÙŠÙ… Ø£Ø²Ø±Ù‚ */
    [data-theme="blue"] {
      --primary: #0288d1;
      --secondary: #ffb74d;
      --accent: #64b5f6;
      --success: #029ae5;
      --gradient: linear-gradient(135deg, #0288d1, #b3e5fc);
      --solid-bg: #0288d1;
      --bg: #f0f8ff;
      --text: #2c5282;
    }

    /* Ø«ÙŠÙ… Ø¨Ù†ÙØ³Ø¬ÙŠ */
    [data-theme="purple"] {
      --primary: #9c27b0;
      --secondary: #ce93d8;
      --accent: #ba68c8;
      --success: #ab47bc;
      --gradient: linear-gradient(135deg, #9c27b0, #ce93d8);
      --solid-bg: #9c27b0;
      --bg: #faf5ff;
      --text: #6b46c1;
    }

    /* Ø«ÙŠÙ… Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ */
    [data-theme="orange"] {
      --primary: #ff9800;
      --secondary: #ffcc80;
      --accent: #ffb74d;
      --success: #ffa726;
      --gradient: linear-gradient(135deg, #ff9800, #ffcc80);
      --solid-bg: #ff9800;
      --bg: #fffaf0;
      --text: #dd6b20;
    }

    /* Ø«ÙŠÙ… ÙˆØ±Ø¯ÙŠ */
    [data-theme="pink"] {
      --primary: #e91e63;
      --secondary: #f48fb1;
      --accent: #f06292;
      --success: #ec407a;
      --gradient: linear-gradient(135deg, #e91e63, #f48fb1);
      --solid-bg: #e91e63;
      --bg: #fff5f7;
      --text: #d53f8c;
    }

    /* Ø«ÙŠÙ… Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† */
    [data-theme="dark-blue"] {
      --primary: #1e3a8a;
      --secondary: #60a5fa;
      --accent: #3b82f6;
      --success: #2563eb;
      --gradient: linear-gradient(135deg, #1e3a8a, #60a5fa);
      --solid-bg: #1e3a8a;
      --bg: #eff6ff;
      --text: #1e40af;
    }

    body {
      background: var(--bg);
      font-family: 'Cairo', sans-serif;
      text-align: center;
      padding: 20px;
      color: var(--text);
      transition: all var(--transition-slow);
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background-attachment: fixed;
    }

    body.dark {
      --bg: #121212;
      --text: #e2e8f0;
      --card-bg: #1e1e1e;
      --border-color: #2d3748;
      --shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    .header {
      margin-bottom: 30px;
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      color: var(--primary);
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .subtitle {
      font-size: 1.1rem;
      color: var(--text);
      opacity: 0.8;
      margin-bottom: 30px;
    }

    /* Ø¯Ø§Ø¦Ø±Ø© Ø§Ù„ØªØ³Ø¨ÙŠØ­ - ØªØµÙ…ÙŠÙ… Ù…ØªØ·ÙˆØ± */
    .circle-container {
      position: relative;
      margin: 30px auto;
      width: 250px;
      height: 250px;
    }

    .circle {
      position: relative;
      width: 100%;
      height: 100%;
      cursor: pointer;
      background: var(--gradient);
      border-radius: 50%;
      box-shadow: var(--shadow), 0 0 0 4px rgba(255, 255, 255, 0.1) inset;
      transition: all var(--transition-fast);
      display: flex;
      align-items: center;
      justify-content: center;
      
      /* Ù…Ù†Ø¹ Ø§Ù„Ù…Ø±Ø¨Ø¹ Ø§Ù„Ø£Ø²Ø±Ù‚ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ¯ */
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      -khtml-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
      user-select: none;
      outline: none;
      tap-highlight-color: transparent;
    }

    .circle:active {
      transform: scale(0.95);
      box-shadow: 0 0 0 4px var(--primary), var(--shadow);
    }

    .circle::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 100%;
      height: 100%;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      transform: translate(-50%, -50%) scale(0);
      opacity: 0;
      transition: transform 0.6s, opacity 0.6s;
    }

    .circle:active::after {
      transform: translate(-50%, -50%) scale(1.1);
      opacity: 1;
    }

    .circle svg {
      width: 200px;
      height: 200px;
    }

    .circle text {
      font-size: 2.5rem;
      font-weight: 700;
      fill: white;
      dominant-baseline: middle;
      text-anchor: middle;
      filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    }

    .circle .tasbih-text {
      font-size: 1rem;
      fill: rgba(255, 255, 255, 0.9);
      font-weight: 500;
    }

    /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… */
    .progress-ring {
      transition: all var(--transition-fast);
    }

    /* Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin: 30px auto;
      max-width: 600px;
    }

    .stat-card {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      border: 2px solid var(--border-color);
      transition: all var(--transition-fast);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
    }

    .stat-value {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 0.9rem;
      color: var(--text);
      opacity: 0.8;
    }

    /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± - ØªØµÙ…ÙŠÙ… Ù…ØªØ·ÙˆØ± */
    .buttons-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin: 30px auto;
      max-width: 800px;
    }

    .btn {
      padding: 16px 20px;
      border: none;
      border-radius: 15px;
      cursor: pointer;
      transition: all var(--transition-fast);
      font-family: 'Cairo', sans-serif;
      font-weight: 600;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      position: relative;
      overflow: hidden;
      box-shadow: var(--shadow);
      
      /* Ù…Ù†Ø¹ Ø§Ù„ØªØ­Ø¯ÙŠØ¯ */
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
    }

    .btn-secondary {
      background: linear-gradient(135deg, var(--secondary), #ffd54f);
      color: white;
    }

    .btn-accent {
      background: linear-gradient(135deg, var(--accent), #90caf9);
      color: white;
    }

    .btn-success {
      background: linear-gradient(135deg, var(--success), #66bb6a);
      color: white;
    }

    .btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .btn:active {
      transform: translateY(0);
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    /* Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… */
    .level-badge {
      background: linear-gradient(135deg, var(--primary), var(--secondary));
      color: white;
      padding: 12px 25px;
      border-radius: 25px;
      font-weight: 700;
      box-shadow: var(--shadow);
      margin: 20px auto;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      border: 2px solid rgba(255, 255, 255, 0.2);
    }

    /* Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--success), var(--primary));
      color: white;
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      transform: translateX(100%);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      backdrop-filter: blur(10px);
    }

    .notification.show {
      transform: translateX(0);
    }

    /* Ø§Ù„ÙƒÙˆÙ†ÙÙŠØªÙŠ */
    .confetti {
      position: fixed;
      width: 12px;
      height: 12px;
      animation: confettiFall 3s ease-in-out forwards;
      z-index: 999;
      border-radius: 50%;
    }

    @keyframes confettiFall {
      0% {
        transform: translateY(-100vh) rotate(0deg) scale(0);
        opacity: 1;
      }
      100% {
        transform: translateY(100vh) rotate(720deg) scale(1);
        opacity: 0;
      }
    }

    /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù€ glow */
    .glow {
      animation: glowPulse 2s ease-in-out infinite;
    }

    @keyframes glowPulse {
      0%, 100% {
        box-shadow: 0 0 20px var(--primary), 0 0 0 4px rgba(255, 255, 255, 0.1) inset;
      }
      50% {
        box-shadow: 0 0 40px var(--secondary), 0 0 0 4px rgba(255, 255, 255, 0.2) inset;
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .container {
        padding: 15px;
      }
      
      h1 {
        font-size: 2rem;
      }
      
      .circle-container {
        width: 200px;
        height: 200px;
      }
      
      .circle svg {
        width: 160px;
        height: 160px;
      }
      
      .circle text {
        font-size: 2rem;
      }
      
      .buttons-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }
      
      .btn {
        padding: 14px 16px;
        font-size: 0.9rem;
      }
      
      .stats-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    @media (max-width: 480px) {
      h1 {
        font-size: 1.8rem;
      }
      
      .circle-container {
        width: 180px;
        height: 180px;
      }
      
      .buttons-grid {
        grid-template-columns: 1fr;
      }
      
      .stats-grid {
        grid-template-columns: 1fr;
      }
    }
    /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† */
body.dark {
  --bg: #1a202c;
  --text: #e2e8f0;
  --card-bg: #2d3748;
  --border-color: #4a5568;
}

body.dark .stat-card {
  background: #2d3748;
  border: 2px solid #4a5568;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
}

body.dark .stat-card:hover {
  box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
}

body.dark .btn {
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
}

body.dark .btn:hover {
  box-shadow: 0 8px 25px rgba(0, 0, 0, 0.5);
}

body.dark .theme-panel,
body.dark .achievements-panel,
body.dark .settings-panel {
  background: #2d3748;
  border: 2px solid #4a5568;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
}

body.dark .level-badge {
  background: linear-gradient(135deg, #2d3748, #4a5568);
  border: 2px solid #4a5568;
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¹Ø§Ù…Ø© Ù„Ù„ÙˆØ§Ø¬Ù‡Ø© */
.buttons-grid {
  margin: 20px auto;
}

/* Ø¥ØµÙ„Ø§Ø­ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ø²ÙˆÙˆÙ… Ø¹Ù„Ù‰ iOS */
@media screen and (max-width: 768px) {
  input, select, textarea {
    font-size: 16px !important;
  }
}

/* Ù…Ù†Ø¹ highlight Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ØµØ± */
* {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
}

/* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ */
#assistantPanel {
  backdrop-filter: blur(10px);
  border: 1px solid var(--border-color);
}

body.dark #assistantPanel {
  background: linear-gradient(135deg, #2d3748, #4a5568);
}

  </style>
</head>
<body data-theme="green">
  <div class="container">
    <div class="header">
      <h1>ğŸ“¿ Ø³Ø¨Ø­Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªØ·ÙˆØ±Ø©</h1>
      <div class="subtitle">ØªØ³Ø¨ÙŠØ­ Ø±Ù‚Ù…ÙŠ Ø¨ØªØ¬Ø±Ø¨Ø© ÙØ±ÙŠØ¯Ø©</div>
    </div>

    <div class="circle-container">
      <div class="circle" id="circle">
        <svg width="200" height="200" viewBox="0 0 200 200">
          <circle cx="100" cy="100" r="90" stroke="#e2e8f0" stroke-width="12" fill="none"/>
          <circle id="progress" cx="100" cy="100" r="90" stroke="white" stroke-width="12" fill="none"
                  stroke-dasharray="565.48" stroke-dashoffset="565.48" transform="rotate(-90 100 100)"
                  class="progress-ring"/>
          <text x="100" y="90" id="countText">0</text>
          <text x="100" y="110" id="tasbihText" class="tasbih-text">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</text>
        </svg>
      </div>
    </div>

    <div class="level-badge">
      <i class="fas fa-star"></i>
      <span>Ø§Ù„Ù…Ø³ØªÙˆÙ‰: <span id="userLevel">1</span></span>
      <span>â€¢</span>
      <span>Ø§Ù„Ù†Ù‚Ø§Ø·: <span id="userPoints">0</span></span>
    </div>

    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-value" id="dailyCount">0</div>
        <div class="stat-label">Ø§Ù„ÙŠÙˆÙ…</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="weeklyCount">0</div>
        <div class="stat-label">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="totalCount">0</div>
        <div class="stat-label">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</div>
      </div>
      <div class="stat-card">
        <div class="stat-value" id="elapsedTime">0:00</div>
        <div class="stat-label">Ø§Ù„ÙˆÙ‚Øª</div>
      </div>
    </div>

    <div class="buttons-grid">
      <button class="btn btn-primary" id="resetBtn">
        <i class="fas fa-undo"></i> ØªØµÙÙŠØ±
      </button>
      <button class="btn btn-secondary" id="themeBtn">
        <i class="fas fa-palette"></i> Ø§Ù„Ø«ÙŠÙ…
      </button>
      <button class="btn btn-accent" id="soundBtn">
        <i class="fas fa-volume-up"></i> ØµÙˆØª
      </button>
      <button class="btn btn-success" id="kineticBtn">
        <i class="fas fa-hand-rock"></i> ÙƒÙŠÙ†ÙˆÙŠ
      </button>
      <button class="btn btn-primary" id="achievementsBtn">
        <i class="fas fa-trophy"></i> Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
      </button>
      <button class="btn btn-secondary" id="settingsBtn">
        <i class="fas fa-cog"></i> Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      </button>
    </div>
    <!-- Ù„ÙˆØ­Ø© Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø«ÙŠÙ…Ø§Øª -->
<div class="theme-panel" id="themePanel" style="display: none; margin: 30px auto; padding: 25px; background: var(--card-bg); border-radius: 20px; box-shadow: var(--shadow);">
  <h3 style="margin-bottom: 20px; color: var(--primary);">ğŸ¨ Ø§Ø®ØªØ± Ø§Ù„Ù…Ø¸Ù‡Ø±</h3>
  <div class="themes-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(100px, 1fr)); gap: 15px;">
    <div class="theme-option" data-theme="green" style="background: linear-gradient(135deg, #4caf50, #a5d6a7); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      Ø£Ø®Ø¶Ø± ğŸŒ¿
    </div>
    <div class="theme-option" data-theme="blue" style="background: linear-gradient(135deg, #0288d1, #b3e5fc); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      Ø£Ø²Ø±Ù‚ ğŸŒŠ
    </div>
    <div class="theme-option" data-theme="purple" style="background: linear-gradient(135deg, #9c27b0, #ce93d8); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      Ø¨Ù†ÙØ³Ø¬ÙŠ ğŸ’œ
    </div>
    <div class="theme-option" data-theme="orange" style="background: linear-gradient(135deg, #ff9800, #ffcc80); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ğŸŠ
    </div>
    <div class="theme-option" data-theme="pink" style="background: linear-gradient(135deg, #e91e63, #f48fb1); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      ÙˆØ±Ø¯ÙŠ ğŸŒ¸
    </div>
    <div class="theme-option" data-theme="dark-blue" style="background: linear-gradient(135deg, #1e3a8a, #60a5fa); padding: 20px; border-radius: 15px; cursor: pointer; text-align: center; color: white; font-weight: bold; border: 3px solid transparent; transition: all 0.3s ease;">
      Ø£Ø²Ø±Ù‚ Ø¯Ø§ÙƒÙ† ğŸŒŒ
    </div>
  </div>
</div>

<!-- Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª -->
<div class="achievements-panel" id="achievementsPanel" style="display: none; margin: 30px auto; padding: 25px; background: var(--card-bg); border-radius: 20px; box-shadow: var(--shadow);">
  <h3 style="margin-bottom: 20px; color: var(--primary);">ğŸ† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª</h3>
  <div id="achievementsGrid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 15px;">
    <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„ÙƒÙˆØ¯ -->
  </div>
</div>

<!-- Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙŠÙ†ÙˆÙŠ -->
<div class="kinetic-mode" id="kineticMode" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; display: flex; flex-direction: column; justify-content: center; align-items: center; color: white;">
  <div style="font-size: 3rem; margin-bottom: 20px;">ğŸ“±</div>
  <div class="kinetic-circle" style="width: 120px; height: 120px; border: 4px solid var(--secondary); border-radius: 50%; display: flex; justify-content: center; align-items: center; font-size: 2rem; margin-bottom: 20px; animation: pulse 2s infinite;">
    <span id="kineticCount">0</span>
  </div>
  <div style="font-size: 1.2rem; margin-bottom: 10px;">Ù‡Ø² Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø¹Ø¯</div>
  <div style="font-size: 1rem; opacity: 0.8; margin-bottom: 30px;">Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©: <span id="sensitivity">5</span></div>
  <div style="display: flex; gap: 15px; margin-bottom: 20px;">
    <button onclick="adjustSensitivity(-1)" style="padding: 10px 20px; background: var(--secondary); color: white; border: none; border-radius: 10px; cursor: pointer;">
      - Ø­Ø³Ø§Ø³ÙŠØ©
    </button>
    <button onclick="adjustSensitivity(1)" style="padding: 10px 20px; background: var(--secondary); color: white; border: none; border-radius: 10px; cursor: pointer;">
      + Ø­Ø³Ø§Ø³ÙŠØ©
    </button>
  </div>
  <button onclick="exitKineticMode()" style="padding: 12px 30px; background: var(--danger); color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 1.1rem;">
    <i class="fas fa-times"></i> Ø®Ø±ÙˆØ¬
  </button>
</div>

<!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
<div class="settings-panel" id="settingsPanel" style="display: none; margin: 30px auto; padding: 25px; background: var(--card-bg); border-radius: 20px; box-shadow: var(--shadow);">
  <h3 style="margin-bottom: 20px; color: var(--primary);">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
  <div class="settings-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
    <div class="setting-group">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text);">Ù†ÙˆØ¹ Ø§Ù„ØªØ³Ø¨ÙŠØ­:</label>
      <select id="tasbihType" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1rem;">
        <option value="33" data-text="Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ (33)</option>
        <option value="33" data-text="Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡">Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡ (33)</option>
        <option value="34" data-text="Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø± (34)</option>
        <option value="100" data-text="ØªØ³Ø¨ÙŠØ­ Ø¹Ø§Ù…">ØªØ³Ø¨ÙŠØ­ Ø¹Ø§Ù… (100)</option>
      </select>
    </div>

    <div class="setting-group">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text);">Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø®ØµØµ:</label>
      <input type="number" id="alertLimit" value="33" min="10" max="1000" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1rem;">
    </div>

    <div class="setting-group">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text);">Ù†ÙˆØ¹ Ø§Ù„ØµÙˆØª:</label>
      <select id="soundType" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1rem;">
        <option value="keyboard" data-freq="600">ÙƒÙŠØ¨ÙˆØ±Ø¯ âŒ¨ï¸</option>
        <option value="light" data-freq="800">Ù†Ù‚Ø±Ø© Ø®ÙÙŠÙØ© ğŸ””</option>
        <option value="deep" data-freq="400">Ù†Ù‚Ø±Ø© Ø¹Ù…ÙŠÙ‚Ø© ğŸ¥</option>
      </select>
    </div>

    <div class="setting-group">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--text);">Ø§Ù„Ù„ØºØ©:</label>
      <select id="language" style="width: 100%; padding: 12px; border: 2px solid var(--border-color); border-radius: 10px; background: var(--bg); color: var(--text); font-size: 1rem;">
        <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ğŸ‡¸ğŸ‡¦</option>
        <option value="en">English ğŸ‡ºğŸ‡¸</option>
      </select>
    </div>
  </div>
  
  <button id="saveSettingsBtn" style="margin-top: 25px; padding: 15px 30px; background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; border: none; border-radius: 12px; cursor: pointer; font-size: 1.1rem; font-weight: 600; width: 100%;">
    <i class="fas fa-save"></i> Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  </button>
</div>

<!-- Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª -->
<div class="notification" id="notification">
  <span id="notificationText"></span>
</div>

<script>
  // Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª
  let count = 0;
  let limit = 33;
  let soundOn = true;
  let tasbihText = "Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡";
  let dailyCount = 0;
  let weeklyCount = 0;
  let totalCount = 0;
  let soundFreq = 600;
  let startTime = null;
  let language = "ar";
  let audioContext = null;
  let history = JSON.parse(localStorage.getItem("tasbihHistory")) || [];
  let userLevel = 1;
  let userPoints = 0;
  let currentTheme = "green";
  
  // Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙŠÙ†ÙˆÙŠ
  let kineticCount = 0;
  let kineticActive = false;
  let lastShakeTime = 0;
  let shakeThreshold = 5;
  let kineticTimer = null;

  // Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
  const achievementsData = [
    {
      id: 1,
      name: "Ø§Ù„Ù…Ø¨ØªØ¯Ø¦",
      description: "Ø£ÙƒÙ…Ù„ 100 ØªØ³Ø¨ÙŠØ­Ø©",
      target: 100,
      points: 10,
      medal: "ğŸ¥‰",
      unlocked: false
    },
    {
      id: 2,
      name: "Ø§Ù„Ù…Ø«Ø§Ø¨Ø±", 
      description: "Ø£ÙƒÙ…Ù„ 500 ØªØ³Ø¨ÙŠØ­Ø©",
      target: 500,
      points: 25,
      medal: "ğŸ¥ˆ",
      unlocked: false
    },
    {
      id: 3,
      name: "Ø§Ù„Ù…Ù†ØªØ¬",
      description: "Ø£ÙƒÙ…Ù„ 1000 ØªØ³Ø¨ÙŠØ­Ø©", 
      target: 1000,
      points: 50,
      medal: "ğŸ¥‡",
      unlocked: false
    },
    {
      id: 4,
      name: "Ø§Ù„Ù…ØªÙˆØ§ØµÙ„",
      description: "ØªØ³Ø¨ÙŠØ­ Ù„Ù…Ø¯Ø© 7 Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©",
      target: 7,
      points: 30,
      medal: "ğŸ“…",
      unlocked: false
    },
    {
      id: 5,
      name: "Ø§Ù„Ù…Ø­ØªØ±Ù",
      description: "Ø£ÙƒÙ…Ù„ 5000 ØªØ³Ø¨ÙŠØ­Ø©",
      target: 5000,
      points: 100,
      medal: "ğŸ†",
      unlocked: false
    }
  ];

  const translations = {
    ar: {
      title: "ğŸ“¿ Ø³Ø¨Ø­Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ù…ØªØ·ÙˆØ±Ø©",
      reset: "ØªØµÙÙŠØ±",
      theme: "Ø§Ù„Ø«ÙŠÙ…",
      soundOn: "ØµÙˆØª",
      soundOff: "ØµØ§Ù…Øª",
      kinetic: "ÙƒÙŠÙ†ÙˆÙŠ",
      achievements: "Ø¥Ù†Ø¬Ø§Ø²Ø§Øª",
      settings: "Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª",
      daily: "Ø§Ù„ÙŠÙˆÙ…",
      weekly: "Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹", 
      total: "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ",
      time: "Ø§Ù„ÙˆÙ‚Øª",
      level: "Ø§Ù„Ù…Ø³ØªÙˆÙ‰",
      points: "Ø§Ù„Ù†Ù‚Ø§Ø·"
    },
    en: {
      title: "ğŸ“¿ Advanced Digital Tasbih", 
      reset: "Reset",
      theme: "Theme",
      soundOn: "Sound",
      soundOff: "Mute",
      kinetic: "Kinetic",
      achievements: "Achievements",
      settings: "Settings",
      daily: "Daily",
      weekly: "Weekly",
      total: "Total", 
      time: "Time",
      level: "Level",
      points: "Points"
    }
  };

  // Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
  function initializeApp() {
    loadUserData();
    setupEventListeners();
    updateUI();
    startTimer();
    updateAchievementsDisplay();
  }

  function loadUserData() {
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† localStorage
    count = parseInt(localStorage.getItem("count")) || 0;
    totalCount = parseInt(localStorage.getItem("totalCount")) || 0;
    dailyCount = parseInt(localStorage.getItem("dailyCount")) || 0;
    weeklyCount = parseInt(localStorage.getItem("weeklyCount")) || 0;
    userLevel = parseInt(localStorage.getItem("userLevel")) || 1;
    userPoints = parseInt(localStorage.getItem("userPoints")) || 0;
    currentTheme = localStorage.getItem("currentTheme") || "green";
    
    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ…
    document.body.setAttribute("data-theme", currentTheme);
    
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    const savedAchievements = localStorage.getItem("achievements");
    if (savedAchievements) {
      achievements = JSON.parse(savedAchievements);
    } else {
      achievements = achievementsData.map(ach => ({...ach}));
    }

    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„ÙŠÙˆÙ…ÙŠ
    const today = new Date().toDateString();
    const savedDate = localStorage.getItem("tasbihDate");
    if (savedDate !== today) {
      dailyCount = 0;
      localStorage.setItem("tasbihDate", today);
    }
  }

  function setupEventListeners() {
    // Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    document.getElementById("circle").addEventListener("click", handleCircleClick);
    document.getElementById("resetBtn").addEventListener("click", resetCounter);
    document.getElementById("themeBtn").addEventListener("click", toggleThemePanel);
    document.getElementById("soundBtn").addEventListener("click", toggleSound);
    document.getElementById("kineticBtn").addEventListener("click", startKineticMode);
    document.getElementById("achievementsBtn").addEventListener("click", toggleAchievementsPanel);
    document.getElementById("settingsBtn").addEventListener("click", toggleSettingsPanel);
    document.getElementById("saveSettingsBtn").addEventListener("click", saveSettings);

    // Ù…Ù†ØªÙ‚ÙŠ Ø§Ù„Ø«ÙŠÙ…Ø§Øª
    document.querySelectorAll(".theme-option").forEach(option => {
      option.addEventListener("click", () => changeTheme(option.dataset.theme));
    });

    // Ù…Ø³ØªØ´Ø¹Ø± Ø§Ù„Ù‡Ø² Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙŠÙ†ÙˆÙŠ
    if (window.DeviceMotionEvent) {
      window.addEventListener('devicemotion', handleDeviceMotion);
    }

    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØªØ³Ø¨ÙŠØ­
    document.getElementById("tasbihType").addEventListener("change", updateTasbihSettings);
    document.getElementById("soundType").addEventListener("change", updateSoundSettings);
    document.getElementById("language").addEventListener("change", updateLanguageSettings);
  }

  function updateUI() {
    // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    document.getElementById("countText").textContent = count;
    document.getElementById("tasbihText").textContent = tasbihText;
    document.getElementById("dailyCount").textContent = dailyCount;
    document.getElementById("weeklyCount").textContent = weeklyCount;
    document.getElementById("totalCount").textContent = totalCount;
    document.getElementById("userLevel").textContent = userLevel;
    document.getElementById("userPoints").textContent = userPoints;
    
    // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
    updateProgress();
    
    // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
    updateButtonText();
  }

  function updateProgress() {
    const circumference = 2 * Math.PI * 90;
    const percent = (count % limit) / limit;
    const offset = circumference - (percent * circumference);
    
    const progressCircle = document.getElementById("progress");
    if (progressCircle) {
      progressCircle.style.strokeDashoffset = offset;
      
      // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø§Ù„Ø´Ø±ÙŠØ· Ø­Ø³Ø¨ Ø§Ù„Ù†Ø³Ø¨Ø©
      const hue = 120 - (percent * 120); // Ù…Ù† Ø£Ø®Ø¶Ø± Ø¥Ù„Ù‰ Ø£Ø­Ù…Ø±
      progressCircle.style.stroke = `hsl(${hue}, 80%, 60%)`;
    }
  }
  function handleCircleClick() {
  count++;
  dailyCount++;
  weeklyCount++;
  totalCount++;
  
  // Ù…Ù†Ø­ Ù†Ù‚Ø·Ø© Ù„ÙƒÙ„ ØªØ³Ø¨ÙŠØ­Ø©
  userPoints++;
  
  // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  saveUserData();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  updateUI();
  
  // ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
  if (soundOn) {
    playBeep();
  }
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
  if (count % limit === 0 && count > 0) {
    handleCircleCompletion();
  }
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
  checkAchievements();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø³ØªÙˆÙ‰
  updateLevel();
}

function playBeep() {
  if (!audioContext) {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
  }
  
  const oscillator = audioContext.createOscillator();
  const gainNode = audioContext.createGain();
  
  oscillator.type = 'sine';
  oscillator.frequency.setValueAtTime(soundFreq, audioContext.currentTime);
  gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
  
  oscillator.connect(gainNode);
  gainNode.connect(audioContext.destination);
  
  oscillator.start();
  oscillator.stop(audioContext.currentTime + 0.05);
}

function handleCircleCompletion() {
  // ØªØ£Ø«ÙŠØ± Ø¨ØµØ±ÙŠ
  const circle = document.getElementById("circle");
  circle.classList.add("glow");
  
  // Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ø³Ø¬Ù„
  history.push({
    date: new Date().toLocaleDateString(),
    count: count,
    duration: document.getElementById("elapsedTime").textContent,
    type: tasbihText
  });
  
  // Ø­ÙØ¸ Ø§Ù„Ø³Ø¬Ù„
  localStorage.setItem("tasbihHistory", JSON.stringify(history));
  
  // Ø¥Ø´Ø¹Ø§Ø±
  showNotification(`ğŸ‰ Ø£ÙƒÙ…Ù„Øª ${count} ØªØ³Ø¨ÙŠØ­Ø©!`, 3000);
  
  // Ù…Ø¤Ø«Ø±Ø§Øª Ø¨ØµØ±ÙŠØ©
  createConfetti();
  
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ£Ø«ÙŠØ± Ø¨Ø¹Ø¯ ÙØªØ±Ø©
  setTimeout(() => {
    circle.classList.remove("glow");
  }, 1500);
}

function createConfetti() {
  const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f9ca24', '#f0932b', '#eb4d4b'];
  
  for (let i = 0; i < 25; i++) {
    setTimeout(() => {
      const confetti = document.createElement('div');
      confetti.className = 'confetti';
      confetti.style.left = Math.random() * 100 + 'vw';
      confetti.style.background = colors[Math.floor(Math.random() * colors.length)];
      confetti.style.animationDuration = (Math.random() * 2 + 2) + 's';
      confetti.style.animationDelay = (Math.random() * 1) + 's';
      document.body.appendChild(confetti);
      
      setTimeout(() => confetti.remove(), 3000);
    }, i * 50);
  }
}

function resetCounter() {
  count = 0;
  startTime = Date.now();
  saveUserData();
  updateUI();
  showNotification("ğŸ”„ ØªÙ… ØªØµÙÙŠØ± Ø§Ù„Ø¹Ø¯Ø§Ø¯", 2000);
}

function toggleThemePanel() {
  const panel = document.getElementById("themePanel");
  panel.style.display = panel.style.display === "none" ? "block" : "none";
  
  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
  document.getElementById("achievementsPanel").style.display = "none";
  document.getElementById("settingsPanel").style.display = "none";
}

function changeTheme(theme) {
  currentTheme = theme;
  document.body.setAttribute("data-theme", theme);
  localStorage.setItem("currentTheme", theme);
  
  // ØªØ­Ø¯ÙŠØ« ØªØ£Ø«ÙŠØ± Ø§Ù„Ø­Ø¯ÙˆØ¯ Ø¹Ù„Ù‰ Ø§Ù„Ø«ÙŠÙ… Ø§Ù„Ù…Ø®ØªØ§Ø±
  document.querySelectorAll('.theme-option').forEach(option => {
    option.style.borderColor = option.dataset.theme === theme ? 'var(--primary)' : 'transparent';
  });
  
  showNotification(`ğŸ¨ ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø«ÙŠÙ… ${getThemeName(theme)}`, 2000);
}

function getThemeName(theme) {
  const themeNames = {
    'green': 'Ø§Ù„Ø£Ø®Ø¶Ø±',
    'blue': 'Ø§Ù„Ø£Ø²Ø±Ù‚',
    'purple': 'Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠ',
    'orange': 'Ø§Ù„Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ',
    'pink': 'Ø§Ù„ÙˆØ±Ø¯ÙŠ',
    'dark-blue': 'Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„Ø¯Ø§ÙƒÙ†'
  };
  return themeNames[theme] || theme;
}

function toggleSound() {
  soundOn = !soundOn;
  saveUserData();
  updateButtonText();
  showNotification(
    soundOn ? 
    "ğŸ”Š Ø§Ù„ØµÙˆØª Ù…ÙØ¹Ù„" : "ğŸ”‡ Ø§Ù„ØµÙˆØª Ù…Ø¹Ø·Ù„", 
    2000
  );
}

function updateButtonText() {
  const soundBtn = document.getElementById("soundBtn");
  if (soundBtn) {
    soundBtn.innerHTML = soundOn ? 
      '<i class="fas fa-volume-up"></i> ØµÙˆØª' : 
      '<i class="fas fa-volume-mute"></i> ØµØ§Ù…Øª';
  }
}

function startKineticMode() {
  const kineticMode = document.getElementById("kineticMode");
  kineticMode.style.display = "flex";
  kineticActive = true;
  kineticCount = 0;
  document.getElementById("kineticCount").textContent = "0";
  
  showNotification("ğŸ“± Ù‡Ø² Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù„Ø¹Ø¯! Ø§Ù„Ø­Ø³Ø§Ø³ÙŠØ©: " + shakeThreshold, 3000);
  
  // Ø¨Ø¯Ø¡è®¡æ—¶å™¨ Ù„Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙŠÙ†ÙˆÙŠ
  kineticTimer = setInterval(() => {
    if (kineticActive) {
      document.getElementById("kineticCount").textContent = kineticCount;
    }
  }, 100);
}

function exitKineticMode() {
  const kineticMode = document.getElementById("kineticMode");
  kineticMode.style.display = "none";
  kineticActive = false;
  
  if (kineticTimer) {
    clearInterval(kineticTimer);
  }
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ³Ø¨ÙŠØ­Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø¯ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
  if (kineticCount > 0) {
    count += kineticCount;
    dailyCount += kineticCount;
    weeklyCount += kineticCount;
    totalCount += kineticCount;
    userPoints += kineticCount;
    
    saveUserData();
    updateUI();
    showNotification(`ğŸ¯ Ø£Ø¶ÙØª ${kineticCount} ØªØ³Ø¨ÙŠØ­Ø© Ø¨Ø§Ù„Ù‡Ø²!`, 3000);
    
    // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
    checkAchievements();
    updateLevel();
  }
}

function handleDeviceMotion(event) {
  if (!kineticActive) return;
  
  const acceleration = event.accelerationIncludingGravity;
  if (!acceleration) return;
  
  const currentTime = new Date().getTime();
  const timeDiff = currentTime - lastShakeTime;
  
  if (timeDiff > 200) { // Ù…Ù†Ø¹ Ø§Ù„Ù‡Ø² Ø§Ù„Ù…ØªÙƒØ±Ø± Ø§Ù„Ø³Ø±ÙŠØ¹
    const x = acceleration.x;
    const y = acceleration.y;
    const z = acceleration.z;
    
    const accelerationMagnitude = Math.sqrt(x * x + y * y + z * z);
    
    if (accelerationMagnitude > shakeThreshold) {
      kineticCount++;
      lastShakeTime = currentTime;
      
      // ØªØ£Ø«ÙŠØ± Ù…Ø±Ø¦ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ù‡Ø²
      const kineticCircle = document.querySelector('.kinetic-circle');
      if (kineticCircle) {
        kineticCircle.style.transform = "scale(1.2)";
        setTimeout(() => {
          kineticCircle.style.transform = "scale(1)";
        }, 200);
      }
      
      // ØµÙˆØª Ø¹Ù†Ø¯ Ø§Ù„Ù‡Ø²
      if (soundOn) {
        playBeep();
      }
    }
  }
}

function adjustSensitivity(amount) {
  shakeThreshold = Math.max(3, Math.min(15, shakeThreshold + amount));
  document.getElementById("sensitivity").textContent = shakeThreshold;
  showNotification(`ğŸ“Š Ø­Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù‡Ø²: ${shakeThreshold}`, 2000);
}

function toggleAchievementsPanel() {
  const panel = document.getElementById("achievementsPanel");
  panel.style.display = panel.style.display === "none" ? "block" : "none";
  
  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
  document.getElementById("themePanel").style.display = "none";
  document.getElementById("settingsPanel").style.display = "none";
  
  updateAchievementsDisplay();
}

function toggleSettingsPanel() {
  const panel = document.getElementById("settingsPanel");
  panel.style.display = panel.style.display === "none" ? "block" : "none";
  
  // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø£Ø®Ø±Ù‰
  document.getElementById("themePanel").style.display = "none";
  document.getElementById("achievementsPanel").style.display = "none";
}

function updateTasbihSettings() {
  const select = document.getElementById("tasbihType");
  const selectedOption = select.options[select.selectedIndex];
  
  limit = parseInt(selectedOption.value);
  tasbihText = selectedOption.dataset.text;
  
  showNotification(`ğŸ“¿ ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰: ${tasbihText}`, 2000);
}

function updateSoundSettings() {
  const select = document.getElementById("soundType");
  const selectedOption = select.options[select.selectedIndex];
  
  soundFreq = parseInt(selectedOption.dataset.freq);
  showNotification(`ğŸ”Š ØµÙˆØª: ${selectedOption.text}`, 2000);
}

function updateLanguageSettings() {
  const select = document.getElementById("language");
  language = select.value;
  
  showNotification(
    language === "ar" ? 
    "ğŸ‡¸ğŸ‡¦ ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" : "ğŸ‡ºğŸ‡¸ Changed to English", 
    2000
  );
}

function saveSettings() {
  // Ø­ÙØ¸ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  updateTasbihSettings();
  updateSoundSettings();
  updateLanguageSettings();
  
  saveUserData();
  showNotification("âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø¬Ø§Ø­", 2000);
}

function startTimer() {
  startTime = startTime || Date.now();
  
  setInterval(() => {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    const minutes = Math.floor(elapsed / 60);
    const seconds = elapsed % 60;
    
    const timeElement = document.getElementById("elapsedTime");
    if (timeElement) {
      timeElement.textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
    }
  }, 1000);
}

function saveUserData() {
  localStorage.setItem("count", count);
  localStorage.setItem("dailyCount", dailyCount);
  localStorage.setItem("weeklyCount", weeklyCount);
  localStorage.setItem("totalCount", totalCount);
  localStorage.setItem("userLevel", userLevel);
  localStorage.setItem("userPoints", userPoints);
  localStorage.setItem("achievements", JSON.stringify(achievements));
  localStorage.setItem("soundOn", soundOn);
  localStorage.setItem("soundFreq", soundFreq);
  localStorage.setItem("language", language);
  localStorage.setItem("limit", limit);
  localStorage.setItem("tasbihText", tasbihText);
}

function showNotification(message, duration = 3000) {
  const notification = document.getElementById("notification");
  const notificationText = document.getElementById("notificationText");
  
  if (notification && notificationText) {
    notificationText.textContent = message;
    notification.classList.add("show");
    
    setTimeout(() => {
      notification.classList.remove("show");
    }, duration);
  }
}

// Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª
function checkAchievements() {
  let newAchievements = false;
  
  achievements.forEach(achievement => {
    if (!achievement.unlocked) {
      let unlocked = false;
      
      switch(achievement.id) {
        case 1: // 100 ØªØ³Ø¨ÙŠØ­Ø©
          unlocked = totalCount >= achievement.target;
          break;
        case 2: // 500 ØªØ³Ø¨ÙŠØ­Ø©
          unlocked = totalCount >= achievement.target;
          break;
        case 3: // 1000 ØªØ³Ø¨ÙŠØ­Ø©
          unlocked = totalCount >= achievement.target;
          break;
        case 4: // 7 Ø£ÙŠØ§Ù… Ù…ØªØªØ§Ù„ÙŠØ©
          unlocked = checkConsecutiveDays() >= achievement.target;
          break;
        case 5: // 5000 ØªØ³Ø¨ÙŠØ­Ø©
          unlocked = totalCount >= achievement.target;
          break;
      }
      
      if (unlocked) {
        achievement.unlocked = true;
        userPoints += achievement.points;
        showAchievementPopup(achievement);
        newAchievements = true;
      }
    }
  });
  
  if (newAchievements) {
    saveUserData();
    updateUI();
  }
}

function checkConsecutiveDays() {
  // ØªØ¨Ø³ÙŠØ· Ù„Ù„Ø¹Ø±Ø¶ - ÙŠÙ…ÙƒÙ† ØªØ·ÙˆÙŠØ±Ù‡ Ù„Ø§Ø­Ù‚Ø§Ù‹
  return dailyCount > 0 ? 1 : 0;
}

function showAchievementPopup(achievement) {
  const popup = document.createElement('div');
  popup.className = 'achievement-popup';
  popup.style.background = `linear-gradient(135deg, var(--primary), var(--secondary))`;
  popup.innerHTML = `
    <div style="font-size: 4rem; margin-bottom: 1rem;">${achievement.medal}</div>
    <h3 style="margin: 0 0 1rem 0; font-size: 1.5rem;">Ù…Ø¨Ø±ÙˆÙƒ! ğŸ‰</h3>
    <p style="margin: 0.5rem 0; font-size: 1.1rem;">${achievement.name}</p>
    <p style="margin: 0.5rem 0; font-size: 0.9rem; opacity: 0.9;">${achievement.description}</p>
    <p style="margin: 1rem 0 0 0; font-size: 1.2rem; font-weight: bold;">+${achievement.points} Ù†Ù‚Ø·Ø©</p>
  `;
  
  document.body.appendChild(popup);
  createConfetti();
  
  setTimeout(() => popup.remove(), 5000);
}

function updateLevel() {
  const newLevel = Math.floor(userPoints / 100) + 1;
  
  if (newLevel > userLevel) {
    userLevel = newLevel;
    showNotification(`ğŸŠ Ù…Ø³ØªÙˆÙ‰ Ø¬Ø¯ÙŠØ¯! Ø£Ù†Øª Ø§Ù„Ø¢Ù† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙ‰ ${userLevel}`, 4000);
    createConfetti();
    saveUserData();
  }
}
      function updateAchievementsDisplay() {
        const grid = document.getElementById("achievementsGrid");
        if (!grid) return;
        
        grid.innerHTML = '';
        
        achievements.forEach(achievement => {
          let progress = 0;
          switch(achievement.id) {
            case 1: case 2: case 3: case 5:
              progress = Math.min((totalCount / achievement.target) * 100, 100);
              break;
            case 4:
              progress = Math.min((checkConsecutiveDays() / achievement.target) * 100, 100);
              break;
          }
          
          const card = document.createElement('div');
          card.style.background = achievement.unlocked ? 
            `linear-gradient(135deg, var(--primary), var(--secondary))` : 'var(--card-bg)';
          card.style.padding = '20px';
          card.style.borderRadius = '15px';
          card.style.textAlign = 'center';
          card.style.border = `3px solid ${achievement.unlocked ? 'gold' : 'var(--border-color)'}`;
          card.style.transition = 'all 0.3s ease';
          card.style.cursor = 'pointer';
          
          card.innerHTML = `
            <div style="font-size: 2.5rem; margin-bottom: 10px;">${achievement.medal}</div>
            <h4 style="margin: 10px 0; color: ${achievement.unlocked ? 'white' : 'var(--text)'}; font-size: 1.1rem;">
              ${achievement.name}
            </h4>
            <p style="font-size: 0.9rem; margin: 5px 0; color: ${achievement.unlocked ? 'rgba(255,255,255,0.9)' : 'var(--text)'}; opacity: 0.8;">
              ${achievement.description}
            </p>
            <div style="background: ${achievement.unlocked ? 'rgba(255,255,255,0.3)' : 'var(--border-color)'}; 
                  height: 8px; border-radius: 4px; margin: 15px 0;">
              <div style="background: ${achievement.unlocked ? 'white' : 'var(--primary)'}; 
                    height: 100%; width: ${progress}%; border-radius: 4px; transition: width 0.5s ease;"></div>
            </div>
            <span style="font-size: 0.85rem; color: ${achievement.unlocked ? 'white' : 'var(--text)'};">
              ${achievement.unlocked ? 'ğŸ† Ù…ÙƒØªÙ…Ù„' : `${Math.round(progress)}% Ù…ÙƒØªÙ…Ù„`}
            </span>
            ${achievement.unlocked ? `
              <div style="margin-top: 10px; font-size: 0.8rem; color: gold;">
                +${achievement.points} Ù†Ù‚Ø·Ø©
              </div>
            ` : ''}
          `;
          
          grid.appendChild(card);
        });
      }

      // Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©
      function checkSeasonalChallenges() {
        const now = new Date();
        const month = now.getMonth() + 1;
        const day = now.getDate();
        
        // Ø±Ù…Ø¶Ø§Ù† (Ø§Ù„Ø´Ù‡Ø± 9)
        if (month === 9) {
          showNotification("", 5000);
        }
        
        // Ø§Ù„Ø¹Ø´Ø± Ø§Ù„Ø£ÙˆØ§Ø®Ø± (Ø£ÙŠØ§Ù… 21-30 Ù…Ù† Ø±Ù…Ø¶Ø§Ù†)
        if (month === 9 && day >= 21 && day <= 30) {
          showNotification("â­ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ø´Ø± Ø§Ù„Ø£ÙˆØ§Ø®Ø±! Ø§ØºØªÙ†Ù… Ù‡Ø°Ù‡ Ø§Ù„Ø£ÙŠØ§Ù… Ø§Ù„Ù…Ø¨Ø§Ø±ÙƒØ©", 5000);
        }
      }

      // Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ (Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª)
      function initializeAssistant() {
        // Ø¥Ø¶Ø§ÙØ© Ù…Ø³Ø§Ø¹Ø¯ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(() => {
          showAssistantMessage("Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø£Ù†Ø§ Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ù„Ù„ØªØ³Ø¨ÙŠØ­. Ø³Ø£Ù‚Ø¯Ù… Ù„Ùƒ Ù†ØµØ§Ø¦Ø­ ÙˆØªØ°ÙƒÙŠØ±Ø§Øª Ù…ÙÙŠØ¯Ø©.");
        }, 5000);
        
        // Ø±Ø³Ø§Ø¦Ù„ ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙƒÙ„ Ø¯Ù‚ÙŠÙ‚Ø©
        setInterval(() => {
          if (Math.random() < 0.3) { // 30% chance
            showRandomAssistantMessage();
          }
        }, 60000);
      }

      function showRandomAssistantMessage() {
        const messages = [
          "ğŸ’¡ ØªØ°ÙƒØ±: Ø§Ù„ØªØ³Ø¨ÙŠØ­ ÙÙŠ Ø§Ù„Ø¬Ù…Ø¹Ø© Ù„Ù‡ Ø£Ø¬Ø± Ù…Ø¶Ø§Ø¹Ù",
          "ğŸŒ… Ø£ÙØ¶Ù„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„ØªØ³Ø¨ÙŠØ­: Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±",
          "ğŸ¯ Ø­Ø§ÙˆÙ„ ØªØ­Ù‚ÙŠÙ‚ Ù‡Ø¯ÙÙƒ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù‚Ø¨Ù„ Ø§Ù„Ù…ØºØ±Ø¨",
          "â­ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© ÙÙŠ Ø§Ù„ØªØ³Ø¨ÙŠØ­ ØªØ²ÙŠØ¯ Ø§Ù„Ø¨Ø±ÙƒØ©",
          "ğŸ¤² Ø§Ø¯Ø¹ Ø§Ù„Ù„Ù‡ Ø¨Ø¹Ø¯ ÙƒÙ„ ØªØ³Ø¨ÙŠØ­Ø© ÙÙ‡Ùˆ ÙˆÙ‚Øª Ù…Ø³ØªØ¬Ø§Ø¨",
          "ğŸ“¿ Ø¬Ø±Ø¨ Ø£Ù†ÙˆØ§Ø¹ Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„ØªØ³Ø¨ÙŠØ­ Ù„Ù„ØªÙ†ÙˆØ¹",
          "ğŸŒ™ ÙÙŠ Ø§Ù„Ù„ÙŠÙ„ ÙŠÙƒÙˆÙ† Ø§Ù„ØªØ±ÙƒÙŠØ² Ø£Ø¹Ù„Ù‰ ÙˆØ§Ù„Ø£Ø¬Ø± Ø£ÙƒØ¨Ø±",
          "ğŸ™ Ø§Ù„ØªØ³Ø¨ÙŠØ­ ÙŠØ·Ù‡Ø± Ø§Ù„Ù‚Ù„Ø¨ ÙˆÙŠØ¬Ù„Ø¨ Ø§Ù„Ø±Ø§Ø­Ø©"
        ];
        
        const randomMessage = messages[Math.floor(Math.random() * messages.length)];
        showAssistantMessage(randomMessage);
      }

      function showAssistantMessage(message) {
        // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯
        let assistant = document.getElementById('assistant');
        if (!assistant) {
          assistant = document.createElement('div');
          assistant.id = 'assistant';
          assistant.style.position = 'fixed';
          assistant.style.bottom = '20px';
          assistant.style.right = '20px';
          assistant.style.background = 'linear-gradient(135deg, var(--primary), var(--accent))';
          assistant.style.color = 'white';
          assistant.style.padding = '15px 20px';
          assistant.style.borderRadius = '15px';
          assistant.style.boxShadow = '0 10px 30px rgba(0,0,0,0.2)';
          assistant.style.zIndex = '999';
          assistant.style.maxWidth = '300px';
          assistant.style.transform = 'translateX(100%)';
          assistant.style.transition = 'transform 0.5s ease';
          assistant.style.cursor = 'pointer';
          assistant.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
              <div style="font-size: 1.2rem;">ğŸ¤–</div>
              <div id="assistantMessage" style="font-size: 0.9rem;"></div>
            </div>
          `;
          document.body.appendChild(assistant);
        }
        
        document.getElementById('assistantMessage').textContent = message;
        assistant.style.transform = 'translateX(0)';
        
        // Ø¥Ø®ÙØ§Ø¡ ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
        setTimeout(() => {
          assistant.style.transform = 'translateX(100%)';
        }, 5000);
      }

      // Ù†Ø¸Ø§Ù… Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      function backupData() {
        const backup = {
          count: count,
          dailyCount: dailyCount,
          weeklyCount: weeklyCount,
          totalCount: totalCount,
          userLevel: userLevel,
          userPoints: userPoints,
          achievements: achievements,
          history: history,
          timestamp: new Date().toISOString()
        };
        
        localStorage.setItem("tasbihBackup", JSON.stringify(backup));
        showNotification("ğŸ’¾ ØªÙ… Ø­ÙØ¸ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©", 2000);
      }

      function restoreBackup() {
        const backup = localStorage.getItem("tasbihBackup");
        if (backup) {
          const data = JSON.parse(backup);
          
          count = data.count || 0;
          dailyCount = data.dailyCount || 0;
          weeklyCount = data.weeklyCount || 0;
          totalCount = data.totalCount || 0;
          userLevel = data.userLevel || 1;
          userPoints = data.userPoints || 0;
          achievements = data.achievements || [];
          history = data.history || [];
          
          saveUserData();
          updateUI();
          showNotification("ğŸ”„ ØªÙ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©", 2000);
        } else {
          showNotification("âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©", 2000);
        }
      }

      // Ø¥Ø¶Ø§ÙØ© Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ù†Ø³Ø® Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ
      function addBackupButtons() {
        const backupBtn = document.createElement('button');
        backupBtn.innerHTML = '<i class="fas fa-save"></i> Ù†Ø³Ø®Ø©';
        backupBtn.className = 'btn btn-accent';
        backupBtn.style.margin = '5px';
        backupBtn.onclick = backupData;
        
        const restoreBtn = document.createElement('button');
        restoreBtn.innerHTML = '<i class="fas fa-undo"></i> Ø§Ø³ØªØ¹Ø§Ø¯Ø©';
        restoreBtn.className = 'btn btn-secondary';
        restoreBtn.style.margin = '5px';
        restoreBtn.onclick = restoreBackup;
        
        const buttonsContainer = document.querySelector('.buttons-grid');
        buttonsContainer.appendChild(backupBtn);
        buttonsContainer.appendChild(restoreBtn);
      }

      // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
      function initialize() {
        initializeApp();
        addBackupButtons();
        initializeAssistant();
        checkSeasonalChallenges();
        
        // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
        setTimeout(() => {
          showNotification("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©! ğŸ‰", 3000);
          
          // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª Ø£ÙˆÙ„ Ù…Ø±Ø©
          checkAchievements();
          updateAchievementsDisplay();
        }, 1000);
      }

      // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„
      document.addEventListener("DOMContentLoaded", initialize);
      // Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† Ø§Ù„Ù…Ø­Ø³Ù‘Ù†
function toggleDarkMode() {
  const isDark = document.body.classList.toggle("dark");
  localStorage.setItem("darkMode", isDark);
  
  // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†
  const darkModeBtn = document.getElementById("darkModeBtn");
  if (darkModeBtn) {
    darkModeBtn.innerHTML = isDark ? 
      '<i class="fas fa-sun"></i> ÙØ§ØªØ­' : 
      '<i class="fas fa-moon"></i> Ø¯Ø§ÙƒÙ†';
  }
  
  showNotification(
    isDark ? 
    "ğŸŒ™ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†" : "â˜€ï¸ ØªÙ… ØªÙØ¹ÙŠÙ„ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­", 
    2000
  );
}

// Ø²Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ
function addAssistantButton() {
  const assistantBtn = document.createElement('button');
  assistantBtn.className = 'btn btn-success';
  assistantBtn.innerHTML = '<i class="fas fa-robot"></i> Ù…Ø³Ø§Ø¹Ø¯';
  assistantBtn.onclick = showAssistantPanel;
  assistantBtn.style.margin = '5px';
  
  const buttonsContainer = document.querySelector('.buttons-grid');
  buttonsContainer.appendChild(assistantBtn);
}

// Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯
function showAssistantPanel() {
  // Ø¥Ù†Ø´Ø§Ø¡ Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø©
  let panel = document.getElementById('assistantPanel');
  if (!panel) {
    panel = document.createElement('div');
    panel.id = 'assistantPanel';
    panel.style.position = 'fixed';
    panel.style.bottom = '20px';
    panel.style.right = '20px';
    panel.style.background = 'linear-gradient(135deg, var(--primary), var(--accent))';
    panel.style.color = 'white';
    panel.style.padding = '20px';
    panel.style.borderRadius = '15px';
    panel.style.boxShadow = '0 10px 40px rgba(0,0,0,0.3)';
    panel.style.zIndex = '1000';
    panel.style.maxWidth = '350px';
    panel.style.maxHeight = '400px';
    panel.style.overflowY = 'auto';
    panel.style.display = 'none';
    
    panel.innerHTML = `
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
        <h3 style="margin: 0; font-size: 1.2rem;">ğŸ¤– Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
        <button onclick="closeAssistantPanel()" style="background: none; border: none; color: white; cursor: pointer; font-size: 1.2rem;">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div id="assistantMessages" style="margin-bottom: 15px;"></div>
      <button onclick="askAssistant()" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.2); color: white; border: none; border-radius: 8px; cursor: pointer;">
        <i class="fas fa-question"></i> Ø§Ø·Ù„Ø¨ Ù†ØµÙŠØ­Ø©
      </button>
    `;
    
    document.body.appendChild(panel);
  }
  
  panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
}

function closeAssistantPanel() {
  const panel = document.getElementById('assistantPanel');
  if (panel) {
    panel.style.display = 'none';
  }
}

function askAssistant() {
  const tips = [
    "ğŸ’¡ Ø¬Ø±Ø¨ Ø§Ù„ØªØ³Ø¨ÙŠØ­ Ø¨Ø¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø± Ù„Ø£Ø¬Ø± Ù…Ø¶Ø§Ø¹Ù",
    "ğŸŒ… Ø£ÙØ¶Ù„ Ø§Ù„Ø£ÙˆÙ‚Ø§Øª: Ø§Ù„ØµØ¨Ø§Ø­ Ø§Ù„Ø¨Ø§ÙƒØ± ÙˆÙ‚Ø¨Ù„ Ø§Ù„ØºØ±ÙˆØ¨",
    "ğŸ¯ Ø­Ø¯Ø¯ Ù‡Ø¯ÙØ§Ù‹ ÙŠÙˆÙ…ÙŠØ§Ù‹ ÙˆØ­Ø§ÙˆÙ„ ØªØ­Ù‚ÙŠÙ‚Ù‡ Ù‚Ø¨Ù„ Ø§Ù„Ù…ØºØ±Ø¨",
    "â­ Ø§Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ© ÙÙŠ Ø§Ù„ØªØ³Ø¨ÙŠØ­ ØªØ²ÙŠØ¯ Ø§Ù„Ø¨Ø±ÙƒØ©",
    "ğŸ¤² Ø§Ø¯Ø¹ Ø§Ù„Ù„Ù‡ Ø¨Ø¹Ø¯ ÙƒÙ„ 33 ØªØ³Ø¨ÙŠØ­Ø© ÙÙ‡Ùˆ ÙˆÙ‚Øª Ù…Ø³ØªØ¬Ø§Ø¨",
    "ğŸ“¿ ØºÙŠØ± Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„ØªØ³Ø¨ÙŠØ­ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±ÙƒÙŠØ²",
    "ğŸŒ™ ÙÙŠ Ø§Ù„Ù„ÙŠÙ„ ÙŠÙƒÙˆÙ† Ø§Ù„Ø°Ù‡Ù† ØµØ§ÙÙŠØ§Ù‹ ÙˆØ§Ù„Ø£Ø¬Ø± Ø£ÙƒØ¨Ø±",
    "ğŸ™ Ø§Ù„ØªØ³Ø¨ÙŠØ­ ÙŠØ·Ù‡Ø± Ø§Ù„Ù‚Ù„Ø¨ ÙˆÙŠØ¨Ø¹Ø¯ Ø§Ù„ÙˆØ³Ø§ÙˆØ³",
    "ğŸš€ Ø£Ù†Øª Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø±ÙŠÙ‚ Ø§Ù„ØµØ­ÙŠØ­! Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªÙ‚Ø¯Ù…",
    "ğŸ† ÙƒÙ„ ØªØ³Ø¨ÙŠØ­Ø© ØªÙ‚Ø±Ø¨Ùƒ Ù…Ù† Ø§Ù„Ù„Ù‡ ÙˆØªØ²ÙŠØ¯ Ø­Ø³Ù†Ø§ØªÙƒ"
  ];
  
  const randomTip = tips[Math.floor(Math.random() * tips.length)];
  addAssistantMessage(randomTip);
}

function addAssistantMessage(message) {
  const messagesContainer = document.getElementById('assistantMessages');
  if (messagesContainer) {
    const messageElement = document.createElement('div');
    messageElement.style.background = 'rgba(255,255,255,0.1)';
    messageElement.style.padding = '12px';
    messageElement.style.borderRadius = '8px';
    messageElement.style.marginBottom = '10px';
    messageElement.style.fontSize = '0.9rem';
    messageElement.textContent = message;
    
    messagesContainer.appendChild(messageElement);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }
}

// ÙÙŠ Ø¯Ø§Ù„Ø© initializeØŒ Ø£Ø¶Ù:
function initialize() {
  initializeApp();
  addBackupButtons();
  addAssistantButton(); // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯
  initializeAssistant();
  checkSeasonalChallenges();
  
  // ØªØ­Ù…ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ† Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„Ø§Ù‹
  const isDarkMode = localStorage.getItem("darkMode") === "true";
  if (isDarkMode) {
    document.body.classList.add("dark");
    // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø²Ø±
    const darkModeBtn = document.getElementById("darkModeBtn");
    if (darkModeBtn) {
      darkModeBtn.innerHTML = '<i class="fas fa-sun"></i> ÙØ§ØªØ­';
    }
  }
  
  showNotification("Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©! ğŸ‰", 3000);
}
// Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 1: Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ø¨Ø¯Ù„Ø§Ù‹ Ù…Ù† ÙˆØ¶Ø¹ Ø§Ù„ÙƒÙŠÙ†ÙˆÙŠ
function ensureMainInterface() {
  const kineticMode = document.getElementById("kineticMode");
  if (kineticMode) {
    kineticMode.style.display = "none";
  }
  kineticActive = false;
  
  // Ø¥Ø¸Ù‡Ø§Ø± ÙƒÙ„ Ø§Ù„Ù„ÙˆØ­Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  document.body.style.overflow = "auto";
}

// Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 2: Ø²Ø± ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£ÙˆØ¶Ø§Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†/ÙØ§ØªØ­
function addDarkModeToggle() {
  // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø²Ø± Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ Ø¥Ù†Ø´Ø§Ø¤Ù‡
  let darkModeBtn = document.getElementById("darkModeBtn");
  
  if (!darkModeBtn) {
    // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø¬Ø¯ÙŠØ¯ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
    darkModeBtn = document.createElement('button');
    darkModeBtn.id = 'darkModeBtn';
    darkModeBtn.className = 'btn btn-secondary';
    darkModeBtn.innerHTML = '<i class="fas fa-moon"></i> Ø¯Ø§ÙƒÙ†';
    darkModeBtn.onclick = toggleDarkMode;
    
    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø± Ø¥Ù„Ù‰ Ø§Ù„Ø´Ø¨ÙƒØ©
    const buttonsContainer = document.querySelector('.buttons-grid');
    if (buttonsContainer) {
      buttonsContainer.appendChild(darkModeBtn);
    }
  }
  
  // ØªØ­Ø¯ÙŠØ« Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ø²Ø± Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø­Ø§Ù„ÙŠ
  const isDark = document.body.classList.contains("dark");
  darkModeBtn.innerHTML = isDark ? 
    '<i class="fas fa-sun"></i> ÙØ§ØªØ­' : 
    '<i class="fas fa-moon"></i> Ø¯Ø§ÙƒÙ†';
}

// Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© 3: Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©
function updateLanguageSettings() {
  const select = document.getElementById("language");
  if (!select) return;
  
  language = select.value;
  localStorage.setItem("language", language);
  
  // ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ù†ØµÙˆØµ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  updateAllTexts();
  
  showNotification(
    language === "ar" ? 
    "ğŸ‡¸ğŸ‡¦ ØªÙ… Ø§Ù„ØªØºÙŠÙŠØ± Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©" : "ğŸ‡ºğŸ‡¸ Changed to English", 
    2000
  );
}

function updateAllTexts() {
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
  const elementsToUpdate = {
    'resetBtn': translations[language].reset,
    'soundBtn': soundOn ? translations[language].soundOn : translations[language].soundOff,
    'kineticBtn': translations[language].kinetic,
    'achievementsBtn': translations[language].achievements,
    'settingsBtn': translations[language].settings,
    'themeBtn': translations[language].theme
  };
  
  // ØªØ­Ø¯ÙŠØ« Ù†ØµÙˆØµ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  Object.keys(elementsToUpdate).forEach(id => {
    const element = document.getElementById(id);
    if (element) {
      const icon = element.querySelector('i')?.outerHTML || '';
      element.innerHTML = icon + ' ' + elementsToUpdate[id];
    }
  });
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
  updateStatsText();
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
  const title = document.querySelector('h1');
  if (title) {
    title.textContent = translations[language].title;
  }
}

function updateStatsText() {
  const statElements = [
    { id: 'dailyCount', label: 'daily' },
    { id: 'weeklyCount', label: 'weekly' },
    { id: 'totalCount', label: 'total' },
    { id: 'elapsedTime', label: 'time' }
  ];
  
  statElements.forEach(stat => {
    const container = document.querySelector(`.stat-card:nth-child(${statElements.indexOf(stat) + 1}) .stat-label`);
    if (container) {
      container.textContent = translations[language][stat.label];
    }
  });
  
  // ØªØ­Ø¯ÙŠØ« Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
  const levelBadge = document.querySelector('.level-badge');
  if (levelBadge) {
    levelBadge.innerHTML = `
      <i class="fas fa-star"></i>
      <span>${translations[language].level}: <span id="userLevel">${userLevel}</span></span>
      <span>â€¢</span>
      <span>${translations[language].points}: <span id="userPoints">${userPoints}</span></span>
    `;
  }
}

// ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
function loadLanguageSetting() {
  const savedLanguage = localStorage.getItem("language");
  if (savedLanguage) {
    language = savedLanguage;
    const select = document.getElementById("language");
    if (select) {
      select.value = language;
    }
  }
}

// ØªÙ‡ÙŠØ¦Ø© Ù…Ø­Ø³Ù†Ø©
function initializeFixed() {
  ensureMainInterface(); // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
  loadLanguageSetting(); // ØªØ­Ù…ÙŠÙ„ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù„ØºØ©
  initializeApp(); // Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
  addDarkModeToggle(); // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¯Ø§ÙƒÙ†
  checkSeasonalChallenges(); // Ø§Ù„ØªØ­Ø¯ÙŠØ§Øª Ø§Ù„Ù…ÙˆØ³Ù…ÙŠØ©
  updateAllTexts(); // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù†ØµÙˆØµ Ø­Ø³Ø¨ Ø§Ù„Ù„ØºØ©
  
  // Ø±Ø³Ø§Ù„Ø© ØªØ±Ø­ÙŠØ¨
  setTimeout(() => {
    showNotification(
      language === "ar" ? 
      "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³Ø¨Ø­Ø© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ù„Ù…ØªØ·ÙˆØ±Ø©! ğŸ‰" : 
      "Welcome to Advanced Digital Tasbih! ğŸ‰", 
      3000
    );
  }, 1000);
}

// Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø¯Ø§Ù„Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
document.addEventListener("DOMContentLoaded", initializeFixed);
// 1. Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„Ù… Ø§Ù„Ø¢Ù„ÙŠ Ø§Ù„Ø°ÙƒÙŠ
const mlSystem = {
  userPatterns: [],
  peakTimes: [],
  suggestions: [],
  
  analyzePatterns() {
    // ØªØ­Ù„ÙŠÙ„ Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªØ³Ø¨ÙŠØ­
    const now = new Date();
    const hour = now.getHours();
    const day = now.getDay();
    
    // ØªØ³Ø¬ÙŠÙ„ Ù†Ù…Ø· Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    this.userPatterns.push({
      timestamp: now,
      hour: hour,
      day: day,
      count: count
    });
    
    // ØªØ­Ù„ÙŠÙ„ Ø£ÙˆÙ‚Ø§Øª Ø§Ù„Ø°Ø±ÙˆØ©
    this.updatePeakTimes(hour);
    
    // ØªÙˆÙ„ÙŠØ¯ Ù†ØµØ§Ø¦Ø­ Ø°ÙƒÙŠØ©
    this.generateSuggestions();
    
    // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    this.saveData();
  },
  
  updatePeakTimes(currentHour) {
    if (!this.peakTimes[currentHour]) {
      this.peakTimes[currentHour] = 0;
    }
    this.peakTimes[currentHour]++;
  },
  
  generateSuggestions() {
    const suggestions = [
      `ğŸ“Š Ø£ÙØ¶Ù„ Ø£ÙˆÙ‚Ø§ØªÙƒ: ${this.getBestTime()}`,
      `ğŸ¯ Ù…Ø¹Ø¯Ù„Ùƒ: ${Math.round(totalCount / 7)} ÙŠÙˆÙ…ÙŠØ§Ù‹`,
      `â­ Ø£Ù†Øª Ø£ÙØ¶Ù„ Ù…Ù† ${this.getPercentile()}% Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†`,
      `ğŸ’¡ Ø¬Ø±Ø¨ Ø§Ù„ØªØ³Ø¨ÙŠØ­ ${this.getOptimalTime()}`
    ];
    
    this.suggestions = suggestions;
  },
  
  getBestTime() {
    const bestHour = this.peakTimes.indexOf(Math.max(...this.peakTimes.filter(Boolean)));
    return bestHour >= 0 ? `Ø§Ù„Ø³Ø§Ø¹Ø© ${bestHour}:00` : 'Ù„Ù… ØªØ­Ø¯Ø¯ Ø¨Ø¹Ø¯';
  },
  
  getPercentile() {
    return Math.min(95, Math.floor((totalCount / 500) * 100));
  },
  
  getOptimalTime() {
    const now = new Date();
    const nextOptimal = (now.getHours() + 3) % 24;
    return `Ø¨Ø¹Ø¯ ${3} Ø³Ø§Ø¹Ø§Øª (âˆ¼${nextOptimal}:00)`;
  },
  
  saveData() {
    localStorage.setItem('mlData', JSON.stringify({
      patterns: this.userPatterns,
      peakTimes: this.peakTimes
    }));
  },
  
  loadData() {
    const saved = JSON.parse(localStorage.getItem('mlData') || '{}');
    this.userPatterns = saved.patterns || [];
    this.peakTimes = saved.peakTimes || [];
  },
  
  getSmartTip() {
    return this.suggestions[Math.floor(Math.random() * this.suggestions.length)];
  }
};

// 2. Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ØªÙ‚ÙˆÙŠÙ… Ø§Ù„Ù‡Ø¬Ø±ÙŠ
const hijriCalendar = {
  currentDate: new Date(),
  
  getHijriDate() {
    const hijriMonths = ['Ù…Ø­Ø±Ù…', 'ØµÙØ±', 'Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø£ÙˆÙ„', 'Ø±Ø¨ÙŠØ¹ Ø§Ù„Ø«Ø§Ù†ÙŠ', 'Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø£ÙˆÙ„Ù‰', 
                        'Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø©', 'Ø±Ø¬Ø¨', 'Ø´Ø¹Ø¨Ø§Ù†', 'Ø±Ù…Ø¶Ø§Ù†', 'Ø´ÙˆØ§Ù„', 'Ø°Ùˆ Ø§Ù„Ù‚Ø¹Ø¯Ø©', 'Ø°Ùˆ Ø§Ù„Ø­Ø¬Ø©'];
    
    // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ§Ø±ÙŠØ® Ù‡Ø¬Ø±ÙŠ (ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ Ø¨Ù€ API Ø­Ù‚ÙŠÙ‚ÙŠ)
    const approxHijriYear = 1445 + Math.floor((this.currentDate.getFullYear() - 2023) * 0.97);
    const hijriMonth = hijriMonths[this.currentDate.getMonth()];
    const hijriDay = this.currentDate.getDate() % 30;
    
    return `${hijriDay} ${hijriMonth} ${approxHijriYear} Ù‡Ù€`;
  },
  
  getSpecialDays() {
    const specialDays = {
      '15': 'Ù…Ù†ØªØµÙ Ø§Ù„Ø´Ù‡Ø± - Ø£ÙŠØ§Ù… Ø¨ÙŠØ¶',
      '27': 'Ù„ÙŠÙ„Ø© Ù…Ø¨Ø§Ø±ÙƒØ©',
      '13': 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¨ÙŠØ¶',
      '14': 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¨ÙŠØ¶',
      'Friday': 'ÙŠÙˆÙ… Ø§Ù„Ø¬Ù…Ø¹Ø© Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ'
    };
    
    return specialDays;
  },
  
  checkSpecialDay() {
    const day = this.currentDate.getDate().toString();
    const dayOfWeek = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'][this.currentDate.getDay()];
    
    const specialDays = this.getSpecialDays();
    return specialDays[day] || specialDays[dayOfWeek];
  },
  
  showHijriNotification() {
    const specialDay = this.checkSpecialDay();
    if (specialDay) {
      showNotification(`ğŸ“… ${specialDay} - Ø§Ù„ÙŠÙˆÙ… ÙŠÙˆÙ… Ù…Ø¨Ø§Ø±Ùƒ!`, 5000);
    }
  }
};

// 3. Ù†Ø¸Ø§Ù… Ø§Ù„ÙƒÙ†ÙˆØ² ÙˆØ§Ù„Ø£Ø³Ø±Ø§Ø±
const treasureSystem = {
  treasures: [
    { id: 1, name: 'ÙƒÙ†Ø² Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©', condition: () => totalCount >= 10, unlocked: false, reward: 20 },
    { id: 2, name: 'ÙƒÙ†Ø² Ø§Ù„Ø§Ù†ØªØ¸Ø§Ù…', condition: () => dailyCount >= 3, unlocked: false, reward: 15 },
    { id: 3, name: 'ÙƒÙ†Ø² Ø§Ù„ØµØ¨Ø§Ø­', condition: () => new Date().getHours() < 10 && count > 0, unlocked: false, reward: 25 },
    { id: 4, name: 'ÙƒÙ†Ø² Ø§Ù„Ù„ÙŠÙ„', condition: () => new Date().getHours() > 20 && count > 0, unlocked: false, reward: 25 },
    { id: 5, name: 'ÙƒÙ†Ø² Ø§Ù„Ù…Ø«Ø§Ø¨Ø±Ø©', condition: () => weeklyCount >= 100, unlocked: false, reward: 50 }
  ],
  
  checkTreasures() {
    this.treasures.forEach(treasure => {
      if (!treasure.unlocked && treasure.condition()) {
        this.unlockTreasure(treasure);
      }
    });
  },
  
  unlockTreasure(treasure) {
    treasure.unlocked = true;
    userPoints += treasure.reward;
    
    showNotification(`ğŸ ÙˆØ¬Ø¯Øª ÙƒÙ†Ø²: ${treasure.name}! +${treasure.reward} Ù†Ù‚Ø·Ø©`, 4000);
    createConfetti();
    
    this.saveTreasures();
  },
  
  saveTreasures() {
    localStorage.setItem('treasures', JSON.stringify(this.treasures));
  },
  
  loadTreasures() {
    const saved = JSON.parse(localStorage.getItem('treasures') || '[]');
    if (saved.length > 0) {
      this.treasures = saved;
    }
  }
};

// 4. Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ÙˆØ³Ù…ÙŠ Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
const seasonalSystem = {
  seasons: {
    ramadan: { start: [4, 1], end: [4, 30], active: false, multiplier: 2 },
    hajj: { start: [6, 1], end: [6, 10], active: false, multiplier: 1.5 },
    muharram: { start: [1, 1], end: [1, 10], active: false, multiplier: 1.3 }
  },
  
  checkSeasons() {
    const now = new Date();
    const currentMonth = now.getMonth() + 1;
    const currentDay = now.getDate();
    
    Object.keys(this.seasons).forEach(season => {
      const s = this.seasons[season];
      s.active = this.isDateInRange(currentMonth, currentDay, s.start, s.end);
      
      if (s.active && !s.notified) {
        showNotification(`ğŸŒ™ ${this.getSeasonName(season)} - Ø§Ù„Ø£Ø¬Ø± Ù…Ø¶Ø§Ø¹Ù!`, 5000);
        s.notified = true;
      }
    });
  },
  
  isDateInRange(month, day, start, end) {
    return month === start[0] && day >= start[1] && day <= end[1];
  },
  
  getSeasonName(season) {
    const names = {
      ramadan: 'Ø´Ù‡Ø± Ø±Ù…Ø¶Ø§Ù† Ø§Ù„Ù…Ø¨Ø§Ø±Ùƒ',
      hajj: 'Ø£ÙŠØ§Ù… Ø§Ù„Ø­Ø¬',
      muharram: 'Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø±Ù…'
    };
    return names[season] || season;
  },
  
  getCurrentMultiplier() {
    const activeSeason = Object.values(this.seasons).find(s => s.active);
    return activeSeason ? activeSeason.multiplier : 1;
  }
};

// 5. Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø§Ù„Ù‚ÙŠÙ…
function addResetAllOption() {
  const resetBtn = document.createElement('button');
  resetBtn.className = 'btn btn-danger';
  resetBtn.innerHTML = '<i class="fas fa-trash"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·';
  resetBtn.onclick = confirmResetAll;
  resetBtn.style.margin = '5px';
  
  const settingsPanel = document.getElementById('settingsPanel');
  if (settingsPanel) {
    settingsPanel.querySelector('.settings-grid').appendChild(resetBtn);
  }
}

function confirmResetAll() {
  if (confirm(language === 'ar' ? 
      'âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù† Ù‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡!' :
      'âš ï¸ Are you sure you want to reset all data? This cannot be undone!')) {
    resetAllData();
  }
}

function resetAllData() {
  // Ù…Ø³Ø­ ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  localStorage.clear();
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
  count = dailyCount = weeklyCount = totalCount = userPoints = 0;
  userLevel = 1;
  achievements = achievementsData.map(ach => ({...ach, unlocked: false}));
  
  // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
  saveUserData();
  updateUI();
  
  showNotification('ğŸ”„ ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 3000);
}
// Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø· Ø§Ù„ÙƒØ§Ù…Ù„ - ÙŠØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
function addSimpleResetButton() {
  // Ø¥Ù†Ø´Ø§Ø¡ Ø²Ø± Ø¨Ø³ÙŠØ· ÙˆØ§Ø¶Ø­
  const resetBtn = document.createElement('button');
  resetBtn.className = 'btn';
  resetBtn.style.background = 'linear-gradient(135deg, #ff4757, #ff3838)';
  resetBtn.style.color = 'white';
  resetBtn.style.margin = '10px';
  resetBtn.style.padding = '15px 25px';
  resetBtn.style.border = 'none';
  resetBtn.style.borderRadius = '10px';
  resetBtn.style.cursor = 'pointer';
  resetBtn.style.fontWeight = 'bold';
  resetBtn.innerHTML = '<i class="fas fa-trash"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ÙƒÙ„';
  
  resetBtn.onclick = function() {
    if (confirm('âš ï¸ Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹!')) {
      localStorage.clear();
      location.reload(); // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    }
  };
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø²Ø± Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  const settingsPanel = document.getElementById('settingsPanel');
  if (settingsPanel) {
    settingsPanel.appendChild(resetBtn);
  }
}
  
  
  

// ØªÙ‡ÙŠØ¦Ø© Ø¨Ø³ÙŠØ·Ø© ØªØ¹Ù…Ù„ Ù…Ø¨Ø§Ø´Ø±Ø©
function simpleInit() {
  // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø¨Ø¹Ø¯ Ø«ÙˆØ§Ù†ÙŠ
  setTimeout(() => {
    addSimpleResetButton();
    addSimpleGlassTheme();
  }, 1000);
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¨Ø³ÙŠØ·Ø©
document.addEventListener('DOMContentLoaded', simpleInit);
// Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø¨ÙŠØ¹ Ø§Ù„Ù…Ù†ÙØµÙ„ - ÙŠØ²ÙŠØ¯ ÙƒÙ„ 7 Ø£ÙŠØ§Ù… ÙÙ‚Ø·
let weekCount = parseInt(localStorage.getItem('weekCount')) || 0;
let lastIncrementDate = localStorage.getItem('lastIncrementDate') || '';

function checkWeeklyIncrement() {
  const today = new Date().toDateString();
  
  // Ø¥Ø°Ø§ ÙƒØ§Ù† ØªØ§Ø±ÙŠØ® Ø¬Ø¯ÙŠØ¯ ÙˆÙ„Ù… ÙŠÙƒÙ† Ø¢Ø®Ø± increment Ø§Ù„ÙŠÙˆÙ…
  if (today !== lastIncrementDate) {
    const lastDate = lastIncrementDate ? new Date(lastIncrementDate) : new Date();
    const timeDiff = new Date() - lastDate;
    const daysDiff = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    
    // ÙƒÙ„ 7 Ø£ÙŠØ§Ù… Ù†Ø²ÙŠØ¯ Ø§Ù„Ø¹Ø¯Ø¯
    if (daysDiff >= 7) {
      weekCount++;
      lastIncrementDate = today;
      localStorage.setItem('weekCount', weekCount);
      localStorage.setItem('lastIncrementDate', lastIncrementDate);
      showNotification(`ğŸ“… ØªÙ… Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ: ${weekCount}`, 3000);
    }
  }
}

// Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¨Ø´ÙƒÙ„ Ù†Ù‡Ø§Ø¦ÙŠ ÙˆÙ‚Ø§Ø·Ø¹
function enforceStrictNoZoom() {
  // Ø¥Ø¶Ø§ÙØ© viewport ØµØ§Ø±Ù…
  const viewport = document.createElement('meta');
  viewport.name = 'viewport';
  viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimum-scale=1.0';
  document.head.appendChild(viewport);
Ø³ØªÙ…Ø¹ÙŠÙ†
  document.addEventListener('touchstart', preventZoom, { passive: false });
  document.addEventListener('touchmove', preventZoom, { passive: false });
  document.addEventListener('touchend', preventZoom, { passive: false });
  document.addEventListener('gesturestart', function(e) {
    e.preventDefault();
    return false;
  });
  document.addEventListener('gesturechange', function(e) {
    e.preventDefault();
    return false;
  });
  document.addEventListener('wheel', function(e) {
    if (e.ctrlKey) {
      e.preventDefault();
      return false;
    }
  }, { passive: false });

  // Ù…Ù†Ø¹ double tap
  let lastTouchTime = 0;
  document.addEventListener('touchend', function(e) {
    const currentTime = new Date().getTime();
    if (currentTime - lastTouchTime < 300) {
      e.preventDefault();
      return false;
    }
    lastTouchTime = currentTime;
  }, { passive: false });
}

// ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© handleCircleClick Ù„ÙØµÙ„ Ø§Ù„Ø¹Ø¯
const originalHandleCircleClick = handleCircleClick;
handleCircleClick = function() {
  count++;
  dailyCount++;
  totalCount++;
  
  userPoints++;
  saveUserData();
  updateUI();
  
  if (soundOn) {
    playBeep();
  }
  
  if (count % limit === 0 && count > 0) {
    handleCircleCompletion();
  }
  
  checkAchievements();
  updateLevel();
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ (Ù…Ù†ÙØµÙ„ ØªÙ…Ø§Ù…Ø§Ù‹)
  checkWeeklyIncrement();
};

// ØªØ­Ø¯ÙŠØ« ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠ Ø§Ù„Ù…Ù†ÙØµÙ„
function updateUIWithWeekly() {
  updateUI();
  const weeklyElement = document.getElementById('weeklyCount');
  if (weeklyElement) {
    weeklyElement.textContent = weekCount;
  }
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
function initSeparateWeeklySystem() {
  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  weekCount = parseInt(localStorage.getItem('weekCount')) || 0;
  lastIncrementDate = localStorage.getItem('lastIncrementDate') || '';
  
  // ØªØ·Ø¨ÙŠÙ‚ Ù…Ù†Ø¹ Ø§Ù„Ø²ÙˆÙ… Ø§Ù„ØµØ§Ø±Ù…
  enforceStrictNoZoom();
  
  // Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„ÙŠÙˆÙ…ÙŠ
  setInterval(checkWeeklyIncrement, 3600000); // ÙƒÙ„ Ø³Ø§Ø¹Ø©
}


// ØªØ­Ø¯ÙŠØ« Ø¯Ø§Ù„Ø© Ø§Ù„Ø­ÙØ¸
const originalSaveUserData = saveUserData;
saveUserData = function() {
  originalSaveUserData();
  localStorage.setItem('weekCount', weekCount);
  localStorage.setItem('lastIncrementDate', lastIncrementDate);
};
// Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¨Ø¯ÙˆÙ† ØªÙ‚ÙŠÙŠØ¯ Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
function preventZoomButAllowTasbih() {
  // Ù…Ù†Ø¹ Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø¹Ù„Ù‰ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØµÙØ­Ø©
  const viewport = document.querySelector('meta[name="viewport"]') || document.createElement('meta');
  viewport.name = 'viewport';
  viewport.content = 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no';
  document.head.appendChild(viewport);

  // Ù…Ù†Ø¹ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø¹Ø§Ù…Ø©
  const preventZoom = function(e) {
    if (e.touches.length > 1) {
      e.preventDefault();
    }
  };

  // ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù„Ù‰ document Ù„ÙƒÙ† Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø©
  document.addEventListener('touchstart', function(e) {
    if (e.touches.length > 1 && !e.target.closest('#circle')) {
      e.preventDefault();
    }
  }, { passive: false });

  document.addEventListener('gesturestart', function(e) {
    if (!e.target.closest('#circle')) {
      e.preventDefault();
    }
  });

  // Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù„Ù…Ø³ Ø¹Ù„Ù‰ Ø§Ù„Ø¯Ø§Ø¦Ø±Ø© ÙÙ‚Ø·
  const circle = document.getElementById('circle');
  if (circle) {
    circle.style.touchAction = 'manipulation';
    circle.style.webkitUserSelect = 'none';
    circle.style.userSelect = 'none';
  }
}

// ØªÙ‡ÙŠØ¦Ø© Ø³Ø±ÙŠØ¹Ø© Ù„Ù„ØªØ³Ø¨ÙŠØ­
function initFastTasbih() {
  const circle = document.getElementById('circle');
  if (circle) {
    circle.onclick = function() {
      count++;
      dailyCount++;
      totalCount++;
      userPoints++;
      
      // ØªØ­Ø¯ÙŠØ« ÙÙˆØ±ÙŠ
      document.getElementById("countText").textContent = count;
      document.getElementById("dailyCount").textContent = dailyCount;
      document.getElementById("totalCount").textContent = totalCount;
      document.getElementById("userPoints").textContent = userPoints;
      
      // ØµÙˆØª Ø³Ø±ÙŠØ¹
      if (soundOn) {
        const beep = new AudioContext();
        const oscillator = beep.createOscillator();
        oscillator.connect(beep.destination);
        oscillator.start();
        oscillator.stop(beep.currentTime + 0.01);
      }
      
      // Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§Øª
      localStorage.setItem("count", count);
      localStorage.setItem("dailyCount", dailyCount);
      localStorage.setItem("totalCount", totalCount);
      localStorage.setItem("userPoints", userPoints);
    };
  }
}

// ØªØ´ØºÙŠÙ„ ÙƒÙ„ Ø´ÙŠØ¡
document.addEventListener('DOMContentLoaded', function() {
  preventZoomButAllowTasbih();
  initFastTasbih();
  
  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  count = parseInt(localStorage.getItem("count")) || 0;
  dailyCount = parseInt(localStorage.getItem("dailyCount")) || 0;
  totalCount = parseInt(localStorage.getItem("totalCount")) || 0;
  userPoints = parseInt(localStorage.getItem("userPoints")) || 0;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
  document.getElementById("countText").textContent = count;
  document.getElementById("dailyCount").textContent = dailyCount;
  document.getElementById("totalCount").textContent = totalCount;
  document.getElementById("userPoints").textContent = userPoints;
});
// Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø© - Ø¥Ø²Ø§Ù„Ø© event listeners Ø§Ù„Ù…ÙƒØ±Ø±Ø©
function fixDoubleIncrement() {
  const circle = document.getElementById('circle');
  if (!circle) return;
  
  // Ø¥Ø²Ø§Ù„Ø© Ø¬Ù…ÙŠØ¹ event listeners Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
  const newCircle = circle.cloneNode(true);
  circle.parentNode.replaceChild(newCircle, circle);
  
  // Ø¥Ø¶Ø§ÙØ© event listener ÙˆØ§Ø­Ø¯ ÙÙ‚Ø·
  newCircle.addEventListener('click', handleTasbihClick, { once: false });
}

// Ø¯Ø§Ù„Ø© Ø§Ù„ØªØ³Ø¨ÙŠØ­ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
function handleTasbihClick(e) {
  e.preventDefault();
  e.stopPropagation();
  e.stopImmediatePropagation();
  
  // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·
  count++;
  dailyCount++;
  totalCount++;
  userPoints++;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© ÙÙˆØ±Ø§Ù‹
  updateDisplay();
  
  // ØµÙˆØª Ø³Ø±ÙŠØ¹
  if (soundOn) {
    playQuickBeep();
  }
  
  // Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  saveData();
}

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶ ÙÙ‚Ø·
function updateDisplay() {
  const countText = document.getElementById("countText");
  const dailyCountElement = document.getElementById("dailyCount");
  const totalCountElement = document.getElementById("totalCount");
  const userPointsElement = document.getElementById("userPoints");
  
  if (countText) countText.textContent = count;
  if (dailyCountElement) dailyCountElement.textContent = dailyCount;
  if (totalCountElement) totalCountElement.textContent = totalCount;
  if (userPointsElement) userPointsElement.textContent = userPoints;
  
  // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
  updateProgress();
}

// ØµÙˆØª Ø³Ø±ÙŠØ¹ Ø¬Ø¯Ø§Ù‹
function playQuickBeep() {
  try {
    if (typeof AudioContext !== 'undefined') {
      const context = new AudioContext();
      const oscillator = context.createOscillator();
      oscillator.connect(context.destination);
      oscillator.start();
      oscillator.stop(context.currentTime + 0.01);
    }
  } catch (error) {
    // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„ØµÙˆØªÙŠØ©
  }
}

// Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
function saveData() {
  localStorage.setItem("count", count);
  localStorage.setItem("dailyCount", dailyCount);
  localStorage.setItem("totalCount", totalCount);
  localStorage.setItem("userPoints", userPoints);
}

// ØªÙ‡ÙŠØ¦Ø© Ø¨Ø³ÙŠØ·Ø©
function simpleInit() {
  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  count = parseInt(localStorage.getItem("count")) || 0;
  dailyCount = parseInt(localStorage.getItem("dailyCount")) || 0;
  totalCount = parseInt(localStorage.getItem("totalCount")) || 0;
  userPoints = parseInt(localStorage.getItem("userPoints")) || 0;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
  updateDisplay();
  
  // Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø²Ø¯ÙˆØ¬Ø©
  setTimeout(fixDoubleIncrement, 100);
}

// ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©
document.addEventListener('DOMContentLoaded', simpleInit);
// Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
function addResetToSettings() {
  // Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ ØªØ­Ù…ÙŠÙ„ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  const checkSettings = setInterval(() => {
    const settingsPanel = document.getElementById('settingsPanel');
    if (settingsPanel) {
      clearInterval(checkSettings);
      
      // Ø¥Ù†Ø´Ø§Ø¡ Ù‚Ø³Ù… Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†
      const resetSection = document.createElement('div');
      resetSection.style.cssText = `
        margin-top: 30px;
        padding-top: 20px;
        border-top: 2px solid var(--border-color);
        text-align: center;
      `;
      
      resetSection.innerHTML = `
        <h4 style="color: var(--danger); margin-bottom: 15px;">
          <i class="fas fa-exclamation-triangle"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
        </h4>
        <button id="resetAllButton" style="
          width: 100%;
          padding: 15px;
          background: linear-gradient(135deg, #ff4757, #ff3838);
          color: white;
          border: none;
          border-radius: 10px;
          cursor: pointer;
          font-weight: bold;
          font-size: 16px;
          transition: all 0.3s ease;
        ">
          <i class="fas fa-trash"></i> Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
        </button>
        <p style="font-size: 12px; color: var(--text); opacity: 0.7; margin-top: 10px;">
          âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª ÙˆØ§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø³ØªØ¹Ø§Ø¯Ø©
        </p>
      `;
      
      // Ø¥Ø¶Ø§ÙØ© Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
      settingsPanel.appendChild(resetSection);
      
      // Ø¥Ø¶Ø§ÙØ© event listener
      document.getElementById('resetAllButton').onclick = function() {
        if (confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ\n\nØ³ÙŠØªÙ… Ø­Ø°Ù:\nâ€¢ Ø¬Ù…ÙŠØ¹ Ø§Ù„ØªØ³Ø¨ÙŠØ­Ø§Øª\nâ€¢ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙŠÙˆÙ…ÙŠØ© ÙˆØ§Ù„Ø£Ø³Ø¨ÙˆØ¹ÙŠØ©\nâ€¢ Ø§Ù„Ù†Ù‚Ø§Ø· ÙˆØ§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª\nâ€¢ Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²Ø§Øª\n\nÙ‡Ø°Ø§ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ø¹Ù†Ù‡!')) {
          resetAllData();
        }
      };
    }
  }, 100);
}

// Ø¯Ø§Ù„Ø© Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø§Ù„ÙƒØ§Ù…Ù„Ø©
function resetAllData() {
  // Ù‚Ø§Ø¦Ù…Ø© Ø¨Ø¬Ù…ÙŠØ¹ Ù…ÙØ§ØªÙŠØ­ localStorage Ø§Ù„ØªÙŠ ÙŠØ¬Ø¨ Ù…Ø³Ø­Ù‡Ø§
  const keysToRemove = [
    'count', 'dailyCount', 'weeklyCount', 'totalCount',
    'userPoints', 'userLevel', 'tasbihDate', 'tasbihHistory',
    'achievements', 'currentTheme', 'soundOn', 'soundFreq',
    'language', 'limit', 'tasbihText', 'currentWeekNumber',
    'weekCount', 'lastIncrementDate', 'glassThemeActive'
  ];
  
  // Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  keysToRemove.forEach(key => localStorage.removeItem(key));
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
  count = 0;
  dailyCount = 0;
  weeklyCount = 0;
  totalCount = 0;
  userPoints = 0;
  userLevel = 1;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù…Ø¨Ø§Ø´Ø±Ø©
  updateAllDisplays();
  
  // Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ù†Ø¬Ø§Ø­
  showNotification('âœ… ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­', 3000);
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø© Ø¨Ø¹Ø¯ Ø«Ø§Ù†ÙŠØ©
  setTimeout(() => location.reload(), 1000);
}

// ØªØ­Ø¯ÙŠØ« Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ±
function updateAllDisplays() {
  const elements = {
    'countText': count,
    'dailyCount': dailyCount,
    'weeklyCount': weeklyCount,
    'totalCount': totalCount,
    'userPoints': userPoints,
    'userLevel': userLevel
  };
  
  for (const [id, value] of Object.entries(elements)) {
    const element = document.getElementById(id);
    if (element) element.textContent = value;
  }
  
  // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
  const progressCircle = document.getElementById('progress');
  if (progressCircle) {
    progressCircle.style.strokeDashoffset = '565.48';
  }
}

// Ø¥Ø´Ø¹Ø§Ø±
function showNotification(message, duration) {
  const notification = document.createElement('div');
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    background: linear-gradient(135deg, #4ecdc4, #44a08d);
    color: white;
    padding: 15px 20px;
    border-radius: 10px;
    z-index: 1000;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, duration);
}

// ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø²Ø± Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
document.addEventListener('DOMContentLoaded', function() {
  // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
  count = parseInt(localStorage.getItem("count")) || 0;
  dailyCount = parseInt(localStorage.getItem("dailyCount")) || 0;
  totalCount = parseInt(localStorage.getItem("totalCount")) || 0;
  userPoints = parseInt(localStorage.getItem("userPoints")) || 0;
  userLevel = parseInt(localStorage.getItem("userLevel")) || 1;
  
  // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ø±Ø¶
  updateAllDisplays();
  
  // Ø¥Ø¶Ø§ÙØ© Ø²Ø± Ø§Ù„Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
  addResetToSettings();
});
    </script>
  </body>
</html>